import{a as e}from"../shared/ssr-window.esm.min.mjs";function a(a){let{swiper:t,extendParams:s,on:r}=a;s({history:{enabled:!1,root:"",replaceState:!1,key:"slides",keepQuery:!1}});let l=!1,i={};const o=e=>e.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),n=a=>{const t=e();let s;s=a?new URL(a):t.location;const r=s.pathname.slice(1).split("/").filter((e=>""!==e)),l=r.length;return{key:r[l-2],value:r[l-1]}},p=(a,s)=>{const r=e();if(!l||!t.params.history.enabled)return;let i;i=t.params.url?new URL(t.params.url):r.location;const n=t.virtual&&t.params.virtual.enabled?t.slidesEl.querySelector(`[data-swiper-slide-index="${s}"]`):t.slides[s];let p=o(n.getAttribute("data-history"));if(t.params.history.root.length>0){let e=t.params.history.root;"/"===e[e.length-1]&&(e=e.slice(0,e.length-1)),p=`${e}/${a?`${a}/`:""}${p}`}else i.pathname.includes(a)||(p=`${a?`${a}/`:""}${p}`);t.params.history.keepQuery&&(p+=i.search);const d=r.history.state;d&&d.value===p||(t.params.history.replaceState?r.history.replaceState({value:p},null,p):r.history.pushState({value:p},null,p))},d=(e,a,s)=>{if(a)for(let r=0,l=t.slides.length;r<l;r+=1){const l=t.slides[r];if(o(l.getAttribute("data-history"))===a){const a=t.getSlideIndex(l);t.slideTo(a,e,s)}}else t.slideTo(0,e,s)},h=()=>{i=n(t.params.url),d(t.params.speed,i.value,!1)};r("init",(()=>{t.params.history.enabled&&(()=>{const a=e();if(t.params.history){if(!a.history||!a.history.pushState)return t.params.history.enabled=!1,void(t.params.hashNavigation.enabled=!0);l=!0,i=n(t.params.url),i.key||i.value?(d(0,i.value,t.params.runCallbacksOnInit),t.params.history.replaceState||a.addEventListener("popstate",h)):t.params.history.replaceState||a.addEventListener("popstate",h)}})()})),r("destroy",(()=>{t.params.history.enabled&&(()=>{const a=e();t.params.history.replaceState||a.removeEventListener("popstate",h)})()})),r("transitionEnd _freeModeNoMomentumRelease",(()=>{l&&p(t.params.history.key,t.activeIndex)})),r("slideChange",(()=>{l&&t.params.cssMode&&p(t.params.history.key,t.activeIndex)}))}export{a as default};