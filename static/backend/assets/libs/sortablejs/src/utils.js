import{IE11OrLess}from"./BrowserInfo.js";import Sortable from"./Sortable.js";const captureMode={capture:!1,passive:!1};function on(t,e,n){t.addEventListener(e,n,!IE11OrLess&&captureMode)}function off(t,e,n){t.removeEventListener(e,n,!IE11OrLess&&captureMode)}function matches(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return!1}return!1}}function getParentOrHost(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function closest(t,e,n,o){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&matches(t,e):matches(t,e))||o&&t===n)return t;if(t===n)break}while(t=getParentOrHost(t))}return null}const R_SPACE=/\s+/g;function toggleClass(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{let o=(" "+t.className+" ").replace(R_SPACE," ").replace(" "+e+" "," ");t.className=(o+(n?" "+e:"")).replace(R_SPACE," ")}}function css(t,e,n){let o=t&&t.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in o||-1!==e.indexOf("webkit")||(e="-webkit-"+e),o[e]=n+("string"==typeof n?"":"px")}}function matrix(t,e){let n="";if("string"==typeof t)n=t;else do{let e=css(t,"transform");e&&"none"!==e&&(n=e+" "+n)}while(!e&&(t=t.parentNode));const o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function find(t,e,n){if(t){let o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function getWindowScrollingElement(){return document.scrollingElement||document.documentElement}function getRect(t,e,n,o,i){if(!t.getBoundingClientRect&&t!==window)return;let r,l,c,s,d,a,u;if(t!==window&&t.parentNode&&t!==getWindowScrollingElement()?(r=t.getBoundingClientRect(),l=r.top,c=r.left,s=r.bottom,d=r.right,a=r.height,u=r.width):(l=0,c=0,s=window.innerHeight,d=window.innerWidth,a=window.innerHeight,u=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!IE11OrLess))do{if(i&&i.getBoundingClientRect&&("none"!==css(i,"transform")||n&&"static"!==css(i,"position"))){let t=i.getBoundingClientRect();l-=t.top+parseInt(css(i,"border-top-width")),c-=t.left+parseInt(css(i,"border-left-width")),s=l+r.height,d=c+r.width;break}}while(i=i.parentNode);if(o&&t!==window){let e=matrix(i||t),n=e&&e.a,o=e&&e.d;e&&(l/=o,c/=n,u/=n,a/=o,s=l+a,d=c+u)}return{top:l,left:c,bottom:s,right:d,width:u,height:a}}function getContentRect(t){let e=getRect(t);const n=parseInt(css(t,"padding-left")),o=parseInt(css(t,"padding-top")),i=parseInt(css(t,"padding-right")),r=parseInt(css(t,"padding-bottom"));return e.top+=o+parseInt(css(t,"border-top-width")),e.left+=n+parseInt(css(t,"border-left-width")),e.width=t.clientWidth-n-i,e.height=t.clientHeight-o-r,e.bottom=e.top+e.height,e.right=e.left+e.width,e}function isScrolledPast(t,e,n){let o=getParentAutoScrollElement(t,!0),i=getRect(t)[e];for(;o;){let t,e=getRect(o)[n];if(t="top"===n||"left"===n?i>=e:i<=e,!t)return o;if(o===getWindowScrollingElement())break;o=getParentAutoScrollElement(o,!1)}return!1}function getChild(t,e,n,o){let i=0,r=0,l=t.children;for(;r<l.length;){if("none"!==l[r].style.display&&l[r]!==Sortable.ghost&&(o||l[r]!==Sortable.dragged)&&closest(l[r],n.draggable,t,!1)){if(i===e)return l[r];i++}r++}return null}function lastChild(t,e){let n=t.lastElementChild;for(;n&&(n===Sortable.ghost||"none"===css(n,"display")||e&&!matches(n,e));)n=n.previousElementSibling;return n||null}function index(t,e){let n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Sortable.clone||e&&!matches(t,e)||n++;return n}function getRelativeScrollOffset(t){let e=0,n=0,o=getWindowScrollingElement();if(t)do{let o=matrix(t),i=o.a,r=o.d;e+=t.scrollLeft*i,n+=t.scrollTop*r}while(t!==o&&(t=t.parentNode));return[e,n]}function indexOfObject(t,e){for(let n in t)if(t.hasOwnProperty(n))for(let o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n);return-1}function getParentAutoScrollElement(t,e){if(!t||!t.getBoundingClientRect)return getWindowScrollingElement();let n=t,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){let t=css(n);if(n.clientWidth<n.scrollWidth&&("auto"==t.overflowX||"scroll"==t.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==t.overflowY||"scroll"==t.overflowY)){if(!n.getBoundingClientRect||n===document.body)return getWindowScrollingElement();if(o||e)return n;o=!0}}}while(n=n.parentNode);return getWindowScrollingElement()}function extend(t,e){if(t&&e)for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function isRectEqual(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}let _throttleTimeout;function throttle(t,e){return function(){if(!_throttleTimeout){let n=arguments,o=this;1===n.length?t.call(o,n[0]):t.apply(o,n),_throttleTimeout=setTimeout((function(){_throttleTimeout=void 0}),e)}}}function cancelThrottle(){clearTimeout(_throttleTimeout),_throttleTimeout=void 0}function scrollBy(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function clone(t){let e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function setRect(t,e){css(t,"position","absolute"),css(t,"top",e.top),css(t,"left",e.left),css(t,"width",e.width),css(t,"height",e.height)}function unsetRect(t){css(t,"position",""),css(t,"top",""),css(t,"left",""),css(t,"width",""),css(t,"height","")}function getChildContainingRectFromElement(t,e,n){const o={};return Array.from(t.children).forEach((i=>{if(!closest(i,e.draggable,t,!1)||i.animated||i===n)return;const r=getRect(i);o.left=Math.min(o.left??1/0,r.left),o.top=Math.min(o.top??1/0,r.top),o.right=Math.max(o.right??-1/0,r.right),o.bottom=Math.max(o.bottom??-1/0,r.bottom)})),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}const expando="Sortable"+(new Date).getTime();export{on,off,matches,getParentOrHost,closest,toggleClass,css,matrix,find,getWindowScrollingElement,getRect,isScrolledPast,getChild,lastChild,index,getRelativeScrollOffset,indexOfObject,getParentAutoScrollElement,extend,isRectEqual,throttle,cancelThrottle,scrollBy,clone,setRect,unsetRect,getContentRect,getChildContainingRectFromElement,expando};