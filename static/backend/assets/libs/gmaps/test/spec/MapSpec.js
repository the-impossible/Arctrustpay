describe("Creating a map",(function(){var e,t,o,n;it("should throw an error if element is not defined",(function(){expect((function(){new GMaps({})})).toThrow("No element defined.")})),describe("With basic options",(function(){beforeEach((function(){e=e||new GMaps({el:"#basic-map",lat:-12.0433,lng:-77.0283,zoom:12})})),it("should create a GMaps object",(function(){expect(e).toBeDefined()})),it("should have centered the map at the initial coordinates",(function(){var t=e.getCenter().lat(),o=e.getCenter().lng();expect(t).toEqual(-12.0433),expect(o).toEqual(-77.0283)})),it("should have the correct zoom",(function(){expect(e.getZoom()).toEqual(12)}))})),describe("With advanced controls",(function(){beforeEach((function(){t=t||new GMaps({el:"#advanced-map",lat:-12.0433,lng:-77.0283,zoomControl:!0,panControl:!1,streetViewControl:!1,mapTypeControl:!1,overviewMapControl:!1})})),it("should show the defined controls",(function(){expect(t.map.zoomControl).toBeTruthy(),expect(t.map.panControl).toBeFalsy(),expect(t.map.streetViewControl).toBeFalsy(),expect(t.map.mapTypeControl).toBeFalsy(),expect(t.map.overviewMapControl).toBeFalsy()}))})),describe("With events",(function(){var e,t=0,n=null;beforeEach((function(){e={onclick:function(e){var t=e.latLng.lat(),n=e.latLng.lng();o.addMarker({lat:t,lng:n,title:"New Marker"})},onzoomchanged:function(){console.log("onzoomchanged"),t=this.getZoom()},oncenterchanged:function(){console.log("oncenterchanged"),n=this.getCenter()}},spyOn(e,"onclick").and.callThrough(),spyOn(e,"onzoomchanged").and.callThrough(),spyOn(e,"oncenterchanged").and.callThrough(),o=o||new GMaps({el:"#map-with-events",lat:-12.0433,lng:-77.0283,click:e.onclick,zoom_changed:e.onzoomchanged,center_changed:e.oncenterchanged})})),it("should respond to zoom_changed event",(function(){o.map.setZoom(16),expect(e.onzoomchanged).toHaveBeenCalled(),expect(t).toEqual(16)})),it("should respond to center_changed event",(function(){o.map.setCenter(new google.maps.LatLng(-12.0907,-77.0227));var t=parseFloat(n.lat().toFixed(4)),c=parseFloat(n.lng().toFixed(4));expect(e.oncenterchanged).toHaveBeenCalled(),expect(t).toEqual(-12.0907),expect(c).toEqual(-77.0227)})),it("should respond to click event",(function(){google.maps.event.trigger(o.map,"click",{latLng:new google.maps.LatLng(-12.0433,-77.0283)}),expect(e.onclick).toHaveBeenCalled(),expect(o.markers.length).toEqual(1)})),afterEach((function(){document.getElementById("map-with-events").innerHTML="",o=null}))})),describe("With custom controls",(function(){var e;beforeEach((function(){e={onclick:function(){n.addMarker({lat:n.getCenter().lat(),lng:n.getCenter().lng()})}},spyOn(e,"onclick").and.callThrough(),(n=new GMaps({el:"#map-with-custom-controls",lat:-12.0433,lng:-77.0283})).addControl({position:"top_right",content:"Add marker at the center",style:{margin:"5px",padding:"1px 6px",border:"solid 1px #717B87",background:"#fff"},events:{click:e.onclick}})})),it("should add the control to the controls collection",(function(){expect(n.controls.length).toEqual(1)})),it("should respond to click event attached to the custom control",(function(){google.maps.event.trigger(n.controls[0],"click"),expect(e.onclick).toHaveBeenCalled(),expect(n.markers.length).toEqual(1)}))}))}));